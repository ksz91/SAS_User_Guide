<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>Nützlicher Code - SAS User Guide</title>
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/font-awesome.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <link href="css/extra.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="index.html">SAS User Guide</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="index.html" class="nav-link">Übersicht</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Daten weiterverarbeiten <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="transp.html" class="dropdown-item">Transponieren</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="export.html" class="nav-link">Daten exportieren</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Spezialthemen <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="server.html" class="dropdown-item">Server-Migration</a>
</li>
                                    
<li>
    <a href="neweg.html" class="dropdown-item">Enterprise Guide 8.3</a>
</li>
                                    
<li>
    <a href="big.html" class="dropdown-item">Grosse Datenmengen</a>
</li>
                                    
<li>
    <a href="rawdata.html" class="dropdown-item">Neue Rohdatenablage</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem active">
                                <a href="code.html" class="nav-link">Nützlicher Code</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="rawdata.html" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" class="nav-link disabled">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#nutzlicher-code" class="nav-link">Nützlicher Code</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#put" class="nav-link">put()</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#substr" class="nav-link">substr()</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#scan" class="nav-link">scan()</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#case-statement" class="nav-link">CASE Statement</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="nutzlicher-code">Nützlicher Code</h1>
<hr />
<p>Auch beim Arbeiten mit Abfragen und Anwendungsroutinen des SAS Enterprise Guide kommt man teilweise nicht ganz um die Verwendung von Code bzw. Funktionen herum. Oft ist es die einzige oder zumindest die beste Möglichkeit, auf einfache und schnelle Art und Weise neue Variablen zu generieren. Im Folgenden sind einige nützliche Funktionen und Statements zusammengetragen. Sie können in einer Abfrage folgendermassen verwendet werden:</p>
<p>Neue berechnete Spalte hinzufügen <img alt="img" src="img/neue_spalte.png" /> -&gt; Erweiterter Ausdruck</p>
<h2 id="put">put()</h2>
<p>Mit der put()-Funktion lässt sich eine numerische Variable mittels Format in eine Textvariable umwandeln.</p>
<blockquote>
<p>put(Variable, Format.)</p>
</blockquote>
<p>Anwendungsbeispiel: Die Personen in einem Datensatz sollen anhand ihres Alters verschiedenen Altersgruppen zugeordnet werden. Anschliessend soll die Anzahl Personen pro Altersgruppe und Geschlecht gezählt werden.</p>
<p><img alt="img" src="img/code1.png" /></p>
<p>Problem: Es reicht nicht, der Variable <em>Alter</em> in der Abfrage ein Format für die Altersgruppen zuzuweisen. Das Format bzw. die Altersgruppe ist zwar im Vordergrund sichtbar, die Variable enthält aber immer noch das exakte Alter. Wird nun die Anzahl Personen nach Geschlecht und Alter gezählt, resultiert überall eine 1, auch wenn es bspw. drei Frauen in der Altersgruppe «20 bis 60» gäbe.</p>
<p><img alt="img" src="img/code2.png" /> <img alt="" src="img/code5.png" /></p>
<p>Ein möglicher Lösungsansatz ist es, die numerische Variable <em>Alter</em> in eine Textvariable <em>Altersgruppe</em> umzuwandeln:</p>
<p><code>put(t1.Alter, fmt_alter.)</code></p>
<p><img alt="img" src="img/code13.png" /></p>
<p>Anschliessend kann die Anzahl Personen nach der Variable <em>Geschlecht</em> und der neuen Variable <em>Altersgruppe</em> gezählt werden.</p>
<p><img alt="img" src="img/code4.png" /></p>
<p>Hinweis: Dieses Problem kann auch mittels <a href="code.html#case-statement">CASE Statement</a> gelöst werden.</p>
<h2 id="substr">substr()</h2>
<p>Mit der substr()-Funktion lässt sich ein Teil eines Strings - ein Substring - extrahieren.</p>
<blockquote>
<p>substr(Variable, Startpunkt, Länge)</p>
</blockquote>
<p>Anwendungsbeispiel: Vom Vornamen der Personen im Datensatz soll jeweils der Anfangsbuchstabe extrahiert und in einer neuen Variable gespeichert werden. Dieser Substring beginnt beim ersten Buchstaben und ist ein Zeichen lang:</p>
<p><code>substr(t1.Name, 1, 1)</code></p>
<p><img alt="img" src="img/code6.png" /></p>
<p>In einer weiteren Variable sollen die zwei letzten Buchstaben des Vornamens gespeichert werden. Dieser Substring beginnt beim zweitletzten Buchstaben und ist zwei Zeichen lang:</p>
<p><code>substr(t1.Name, length(t1.Name)-1, 2)</code></p>
<p><img alt="img" src="img/code7.png" /></p>
<p>Schliesslich soll noch der restliche, mittlere Teil des Vornamens in einer separaten Variable gespeichert werden. Dieser Substring beginnt beim zweiten Buchstaben und enthält alle Zeichen ausser das erste und die letzten zwei, umfasst also «Gesamte Anzahl - 3» Zeichen:</p>
<p><code>substr(t1.Name, 2, length(t1.Name)-3)</code></p>
<p><img alt="img" src="img/code8.png" /></p>
<h2 id="scan">scan()</h2>
<p>Mit der scan()-Funktion lässt sich ein Wort aus einer Reihe von Wörtern extrahieren, welche mit bestimmten Trennzeichen abgetrennt sind.</p>
<blockquote>
<p>scan(Variable, ntes Wort [, Trennzeichen])</p>
</blockquote>
<p>Nach folgenden Trennzeichen wird automatisch gesucht: Leerzeichen ! $ % &amp; ( ) * + , – . / ; &lt; |</p>
<p>Anwendungsbeispiel: In einem Datensatz ist zu jeder Person der komplette Name erfasst. Nachname und Vorname sind dabei mit Komma abgetrennt.</p>
<p><img alt="img" src="img/code9.png" /></p>
<p>Nun sollen zwei neue Variablen erstellt werden, welche den Vornamen und den Nachnamen enthalten:</p>
<p>Vorname: <code>scan(t1.Name, 2)</code><br />
Nachname: <code>scan(t1.Name, 1)</code></p>
<p><img alt="img" src="img/code10.png" /></p>
<p>Problem: Wenn ein Doppelname enthalten ist, funktioniert dieser Code nicht, da der Bindestrich automatisch als Trennzeichen erkennt wird.</p>
<p><img alt="img" src="img/code11.png" /></p>
<p>In diesem Fall muss der Funktion explizit die Information mitgegeben werden, welches Trennzeichen verwendet werden soll:</p>
<p>Vorname: <code>scan(t1.Name, 2, ",")</code><br />
Nachname: <code>scan(t1.Name, 1, ",")</code></p>
<p><img alt="img" src="img/code12.png" /></p>
<h2 id="case-statement">CASE Statement</h2>
<p>Mit einem CASE Statement kann eine neue Variable generiert werden, deren Ausprägungen von der erfüllten Bedingung abhängig sind.</p>
<blockquote>
<p>CASE<br />
   WHEN Bedingung1 THEN Resultat1<br />
   WHEN Bedingung2 THEN Resultat2<br />
   WHEN BedingungN THEN ResultatN<br />
   ELSE Resultat<br />
END</p>
</blockquote>
<p>Anwendungsbeispiel: Die Personen in einem Datensatz sollen anhand ihres Alters verschiedenen Altersgruppen zugeordnet werden. Anschliessend soll die Anzahl Personen pro Altersgruppe und Geschlecht gezählt werden.</p>
<p><img alt="img" src="img/code1.png" /></p>
<p>Dazu wird zuerst mittels CASE-Statement eine neue Variable <em>Altersgruppe</em> generiert:</p>
<p><code>CASE 
    WHEN t1.Alter BETWEEN 0 AND 19 THEN "Bis 20 Jahre" 
    WHEN t1.Alter BETWEEN 20 AND 60 THEN "20 bis 60 Jahre" 
    WHEN t1.Alter &gt; 60 THEN "Über 60 Jahre" 
END</code></p>
<p><img alt="img" src="img/code13.png" /></p>
<p>Anschliessend kann die Anzahl Personen nach der Variable Geschlecht und der neuen Variable Altersgruppe gezählt werden.</p>
<p><img alt="img" src="img/code4.png" /></p>
<p>Hinweis: Dieses Problem kann auch mittels <a href="code.html#put">put()-Funktion</a> gelöst werden.</p>
<hr /></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="js/jquery-3.6.0.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script>
            var base_url = ".",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="js/base.js"></script>
        <script src="search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
