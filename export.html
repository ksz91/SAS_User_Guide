<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>Daten exportieren - SAS User Guide</title>
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/font-awesome.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="css/extra.css" rel="stylesheet">

        <script src="js/jquery-1.10.2.min.js" defer></script>
        <script src="js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="index.html">SAS User Guide</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="index.html" class="nav-link">Übersicht</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Daten weiterverarbeiten <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="transp.html" class="dropdown-item">Transponieren</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem active">
                                <a href="export.html" class="nav-link">Daten exportieren</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Spezialthemen <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="server.html" class="dropdown-item">Server-Migration</a>
</li>
                                    
<li>
    <a href="neweg.html" class="dropdown-item">Enterprise Guide 8.3</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="code.html" class="nav-link">Nützlicher Code</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="transp.html" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="server.html" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#daten-exportieren" class="nav-link">Daten exportieren</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#an-microsoft-excel-senden" class="nav-link">An Microsoft Excel senden</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#ods-excel" class="nav-link">ODS Excel</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="daten-exportieren">Daten exportieren</h1>
<hr />
<h2 id="an-microsoft-excel-senden">An Microsoft Excel senden</h2>
<p>Der Output einer Anwendungsroutine (bspw. Zusammenfassungstabelle) kann folgendermassen in Excel exportiert werden:<br />
<img alt="" src="img/export1.png" />  </p>
<p>Problem: Ist im Enterprise Guide unter «Extras -&gt; Optionen -&gt; Ergebnisse -&gt; Allgemein» das Ergebnisformat HTML ausgewählt, dann wird der entsprechende Output mit einem Punkt als Dezimaltrennzeichen exportiert. In Excel kann damit dann nicht weitergerechnet werden und im schlimmsten Fall wird die Zahl sogar als Datum erkannt.<br />
<img alt="" src="img/export2.png" /> </p>
<p>Es gibt mehrere Möglichkeiten, dieses Problem zu umgehen:  </p>
<ul>
<li>Als Ergebnisformat «SAS Report» anstatt «HTML» auswählen. Wird der Output eines SAS Reports mittels «An Microsoft Excel senden» exportiert, werden die Dezimaltrennzeichen korrekt angezeigt.</li>
<li>Als Ergebnisformat zusätzlich «Excel» auswählen. So wird beim Ausführen der Anwendungsroutine direkt ein Excel-File generiert, das direkt aus SAS mittels Doppelklick geöffnet werden kann.  </li>
<li>Für die numerische Variable das Format <code>NUMXw.d</code> auswählen. Bei einer Zusammenfassungstabelle wird das folgendermassen gemacht: Rechtsklick auf die Statistik (bspw. Sum) -&gt; Datenwerteigenschaften -&gt; Ausgabeformat -&gt; Numerisch -&gt; NUMXw.d.
 <img alt="" src="img/export3.png" />   </li>
<li>Zum Exportieren entweder <a href="http://127.0.0.1:8000/export.html#ods-excel">ODS Excel</a> oder Proc Export (Eintrag dazu folgt) verwenden.</li>
</ul>
<h2 id="ods-excel">ODS Excel</h2>
<p>ODS Excel bietet die Möglichkeit, den Output von SAS-Prozeduren (bspw. Proc Report, Proc Tabulate oder Proc Print) direkt in ein Excel-File zu schreiben.</p>
<blockquote>
<p>ods excel file="&lt;&thinsp;Pfad&thinsp;&gt;\Dateiname.xlsx"  [diverse Optionen];<br />
&nbsp;&nbsp;&nbsp;[proc print, proc report, proc tabulate, o.ä.]<br />
ods csv close;</p>
</blockquote>
<p>Anwendungsbeispiel 1: Mit ODS Excel lässt sich die Struktur einer Webtabelle nachbilden, sodass der generierte Export nur noch mittels Copy-Paste in die Webtabelle eingefügt werden muss.</p>
<p><code>ods excel style=journal  
   file="&lt;Pfad&gt;/SAS-Export T99_9_99.xlsx"  
   options(embedded_titles='yes' sheet_interval='bygroup' sheet_name='#byval1');  
title "Anzahl Personen nach Altersgruppe";
   proc tabulate data=personen;
      by Jahr;
      [hier kommt Code]
   run;  
ods excel close;</code></p>
<ul>
<li><code>style=journal</code>: Bestimmt das Design, in dem der Excel-Export daherkommt. Für eine Übersicht über alle ODS-Styles siehe <a href="https://documentation.sas.com/doc/en/pgmsascdc/9.4_3.3/statug/statug_odsgraph_sect054.htm">hier</a>.</li>
<li><code>embedded_titles='yes'</code> bzw. <code>title</code>: Für die exportierte(n) Tabelle(n) kann ein Titel festgelegt werden. Dasselbe funktioniert auch mit Fussnoten (<code>embedded_footnotes='yes'</code> bzw. <code>footnote</code>).</li>
<li><code>sheet_interval='bygroup'</code>: Für jede Ausprägung der by-Variable wird ein neues Tabellenblatt angelegt, in diesem Beispiel also für jedes Jahr.</li>
<li><code>sheet_name='#byval1'</code>: Die Tabellenblätter werden entsprechend der Ausprägungen der by-Variable benannt, in diesem Beispiel also <em>«2021»</em>, <em>«2020»</em>, <em>«2019»</em>, etc.  </li>
<li><code>proc tabulate</code>: Hier kann bspw. der Code einer Zusammenfassungstabelle eingefügt werden: Doppelklick auf Symbol der Zusammenfassungstabelle -&gt; Code -&gt; Kopieren von «PROC TABULATE» bis «RUN;».  </li>
</ul>
<p>Anwendungsbeispiel 2: Eine leicht modifizierte Form - ODS CSV - findet bei der Produktion von tsv-Files für die interaktiven Indikatoren Anwendung.  </p>
<p><code>ods csv file = "&lt;Pfad&gt;\9999.tsv" encoding='utf-8' options(delimiter="09"x);
   proc tabulate data=personen;
      [hier kommt Code]
   run;
ods csv close;</code></p>
<ul>
<li><code>encoding='utf-8'</code>: Sorgt u.&nbsp;a. dafür, dass die Umlaute richtig dargestellt werden.</li>
<li><code>delimiter="09"x</code>: Erzeugt ein Tabulator-getrenntes Dokument.  </li>
<li><code>proc tabulate</code>: Hier kann bspw. der Code einer Zusammenfassungstabelle eingefügt werden: Doppelklick auf Symbol der Zusammenfassungstabelle -&gt; Code -&gt; Kopieren von «PROC TABULATE» bis «RUN;».</li>
</ul>
<p>Es gibt zahlreiche weitere Möglichkeiten, den Output von ODS Excel zu steuern bzw. anzupassen. Für eine vollständige Übersicht siehe <a href="https://documentation.sas.com/doc/en/pgmsascdc/9.4_3.5/odsug/p09n5pw9ol0897n1qe04zeur27rv.htm">hier</a>.</p>
<p>Weitere Informationen zu ODS Excel finden sich auch auf der Seite zur <a href="http://127.0.0.1:8000/server.html#export-mit-ods-excel">Server-Migration</a>.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = ".",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="js/base.js" defer></script>
        <script src="search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
